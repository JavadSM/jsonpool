!function(t){function n(t){return"[object Object]"==Object.prototype.toString.call(t)}function e(t){return"[object Array]"==Object.prototype.toString.call(t)}t.fn.jsonEditor=function(n,e){e=e||{},n=o(l(n));var r=function(){},a=e.change||r,i=e.propertyclick||r;return this.each(function(){var r,o,l,c,u,s,h;r=t(this),o=n,l=a,c=i,u=e.propertyElement,s=e.valueElement,p(h={target:r,onchange:l,onpropertyclick:c,original:o,propertyElement:u,valueElement:s},o,h.target),t(h.target).on("blur focus",".property, .value",function(){t(this).toggleClass("editing")})})};var r="object array boolean number string null";function a(t,n,e){var r=2==arguments.length;if(n.indexOf(".")>-1){for(var a=t,i=0,o=n.split("."),l=o.length;i<l-1;i++)a=a[o[i]];r?delete a[o[l-1]]:a[o[l-1]]=e}else r?delete t[n]:t[n]=e;return t}function i(t){window.console&&console.error(t)}function o(t){var n;try{n=JSON.parse(t)}catch(t){n=null,i("JSON parse failed.")}return n}function l(t){var n;try{n=JSON.stringify(t)}catch(t){n="null",i("JSON stringify failed.")}return n}function c(n){if(0==n.children(".expander").length){var e=t("<span>",{class:"expander"});e.bind("click",function(){t(this).parent().toggleClass("expanded")}),n.prepend(e)}}function p(r,a,i,u){u=u||"",i.children(".item").remove();for(var d in a)if(a.hasOwnProperty(d)){var g=t("<div>",{class:"item","data-path":u}),y=t(r.propertyElement||"<input>",{class:"property"}),b=t(r.valueElement||"<input>",{class:"value"});(n(a[d])||e(a[d]))&&c(g),g.append(y).append(b),i.append(g),y.val(d).attr("title",d);var m=l(a[d]);b.val(m).attr("title",m),v(g,a[d]),y.change(h(r)),b.change(f(r)),y.click(s(r)),(n(a[d])||e(a[d]))&&p(r,a[d],g,(u?u+".":"")+d)}var j,O,S,E;(n(a)||e(a))&&(j=i,O=function(){!function(t){if(e(t))return t.push(null),!0;if(n(t)){for(var r=1,a="newKey";t.hasOwnProperty(a);)a="newKey"+r,r++;return t[a]=null,!0}}(a),p(r,a,i,u),r.onchange(o(l(r.original)))},S=t("<div>",{class:"item appender"}),(E=t("<button></button>",{class:"property"})).text("Add New Value"),S.append(E),j.append(S),E.click(O))}function u(n,e){t(n).parentsUntil(e.target).each(function(){var n=t(this).data("path");n=(n?n+".":n)+t(this).children(".property").val();var r=l(function(t,n,e){n=n.split(".");for(var r=0;r<n.length;)if(void 0==(t=t[n[r++]]))return e;return t}(e.original,n,null));t(this).children(".value").val(r).attr("title",r)})}function s(n){return function(){var e=t(this).parent().data("path"),r=t(this).attr("title"),a=e?e.split(".").concat([r]).join("']['"):r;n.onpropertyclick("['"+a+"']")}}function h(n){return function(){var e=t(this).parent().data("path"),r=o(t(this).next().val()),i=t(this).val(),c=t(this).attr("title");t(this).attr("title",i),a(n.original,(e?e+".":"")+c),i&&a(n.original,(e?e+".":"")+i,r),u(this,n),i||t(this).parent().remove(),n.onchange(o(l(n.original)))}}function f(r){return function(){var i=t(this).prev().val(),s=o(t(this).val()||"null"),h=t(this).parent(),f=h.data("path");a(r.original,(f?f+".":"")+i,s),!n(s)&&!e(s)||t.isEmptyObject(s)?h.find(".expander, .item").remove():(p(r,s,h,(f?f+".":"")+i),c(h)),v(h,s),u(this,r),r.onchange(o(l(r.original)))}}function v(t,a){var i,o,l,c="null";n(a)?c="object":e(a)?c="array":(l=a,"[object Boolean]"==Object.prototype.toString.call(l)?c="boolean":(o=a,"[object String]"==Object.prototype.toString.call(o)?c="string":(i=a,"[object Number]"==Object.prototype.toString.call(i)&&(c="number")))),t.removeClass(r),t.addClass(c)}}(jQuery);